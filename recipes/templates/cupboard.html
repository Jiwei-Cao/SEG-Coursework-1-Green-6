{% extends 'base_content.html' %}
{% load widget_tweaks %} 
{% block content %}
<style>
  .submit-button {
  border: none;
  border-radius: 20px;
  padding: 0.5rem 1.2rem;
  cursor: pointer;
  transition: transform 0.2s ease;
  box-shadow: 0 6px 18px rgba(0, 0, 0, 0.12);
  background-color: #b7e1f7f2;
  font-size: 13px;
}
</style>
<div class="container">
<h2 class = "mb-4">Your Ingredients <i class="bi bi-basket"></i></h2>
<div class="card shadow-sm mb-4">
  <div class="card-body p-0">
    <ul class="list-group list-group-flush">

      {% for ingredient_item in ingredients_list %}
        <li class="list-group-item d-flex justify-content-between align-items-center py-3">
          
          <span class="fw-medium">
            {{ ingredient_item.ingredient_line }}
          </span>

          <button 
            class="btn btn-sm btn-outline-danger" 
            data-bs-toggle="modal" 
            data-bs-target="#deleteIngredient-{{ ingredient_item.ingredient.pk }}"
          >
            <i class="bi bi-trash3-fill"></i>
          </button>
          <!-- Modal -->
          <div class="modal fade" id="deleteIngredient-{{ingredient_item.ingredient.pk}}" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="staticBackdropLabel" aria-hidden="true">
            <div class="modal-dialog modal-dialog-centered">
              <div class="modal-content">
                <div class="modal-header">
                  <h6 class="modal-title fs-5" id="staticBackdropLabel">Delete {{ingredient_item.ingredient}}</h5>
                  <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                  Are you sure you want to delete this ingredient?
                </div>
                <div class="modal-footer">
                  <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                  <form method="post" action="{% url 'delete_ingredient' ingredient_item.ingredient.pk %}">
                    {% csrf_token %}
                    <button type="submit" class="btn btn-danger">Confirm</button>
                  </form>
                </div>
              </div>
            </div>
          </div>
      </li>
      {% empty %}
          <p class = "text-muted text-center"> No ingredient in cupboard yet. Add some ingredient here <i class="bi bi-arrow-90deg-down"></i></p>
    {% endfor %}
  </ul>
  </div>
  </div>
<h4>Add new ingredient</h4>
<form method="post">
    {% csrf_token %} 
    {% for field in form %} 
        {% if field.name != 'public' %}
        <div class="mb-3">
        <label class="form-label" for="{{ field.id_for_label }}">
            {{ field.label }}
        </label>

        {% if form.is_bound %} 
            {% if field.errors %} 
                {% render_field field class="form-control is-invalid" %} 
            {% else %} 
                {% render_field field class="form-control is-valid" %} 
            {% endif %} 
        {% else %} 
            {% render_field field class="form-control" %} 
        {% endif %} 
        {% if field.help_text %}
            <div class="form-text">{{ field.help_text }}</div>
        {% endif %}

        <div class="invalid-feedback">{{ field.errors }}</div>
        </div>
        {% endif %} 
    {% endfor %}
    <button type="submit" class = "submit-button">Add Ingredient</button>
</form>
</div>
{% endblock %}