{% extends 'base_content.html' %}
{% block content %}

<h1>User search</h1>

<form method="get">
    <input type="text" name="q" value="{{ query }}" placeholder="Search users">
    <button type="submit">Search</button>
</form>

{% if has_query %}
    <h2>Results</h2>
{% else %}
    <h2>Suggested users</h2>
{% endif %}

<ul>
    {% for user in top_users %}
        <li>
            <a href="{% url 'user_profile' user.username %}">
                {{ user.username }}
            </a>

            {% if user.id in following_ids %}
                <form method="post" action="{% url 'unfollow_user' user.id %}?next={{ request.path }}{% if query %}&q={{ query }}{% endif %}">
                    {% csrf_token %}
                    <button type="submit">Unfollow</button>
                </form>
            {% else %}
                <form method="post" action="{% url 'follow_user' user.id %}?next={{ request.path }}{% if query %}&q={{ query }}{% endif %}">
                    {% csrf_token %}
                    <button type="submit">Follow</button>
                </form>
            {% endif %}
        </li>
    {% empty %}
        <li>No users found.</li>
    {% endfor %}
</ul>

{% endblock %}
